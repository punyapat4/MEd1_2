<!doctype html>
<html lang="th" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Video Project Delivery | Final Edit</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&family=Prompt:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    * { font-family: 'Kanit', 'Prompt', sans-serif; }
    @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }
    @keyframes pulse-glow { 0%, 100% { box-shadow: 0 0 20px rgba(147, 51, 234, 0.4); } 50% { box-shadow: 0 0 40px rgba(147, 51, 234, 0.8); } }
    @keyframes shimmer { 0% { background-position: -200% center; } 100% { background-position: 200% center; } }
    @keyframes spin-slow { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    .float-animation { animation: float 3s ease-in-out infinite; }
    .pulse-glow { animation: pulse-glow 2s ease-in-out infinite; }
    .shimmer-text {
      background: linear-gradient(90deg, #a855f7, #ec4899, #f97316, #ec4899, #a855f7);
      background-size: 200% auto; -webkit-background-clip: text; background-clip: text;
      -webkit-text-fill-color: transparent; animation: shimmer 3s linear infinite;
    }
    .gradient-border { position: relative; background: linear-gradient(135deg, #1e1b4b 0%, #312e81 50%, #1e1b4b 100%); border-radius: 24px; }
    .gradient-border::before {
      content: ''; position: absolute; inset: -3px;
      background: linear-gradient(45deg, #a855f7, #ec4899, #f97316, #eab308, #a855f7);
      border-radius: 27px; z-index: -1; animation: spin-slow 4s linear infinite;
    }
    .glass-card { background: rgba(30, 27, 75, 0.8); backdrop-filter: blur(20px); border: 1px solid rgba(168, 85, 247, 0.3); }
    .countdown-ring { stroke-dasharray: 283; stroke-dashoffset: 0; transition: stroke-dashoffset 1s linear; }
    .btn-ready { background: linear-gradient(135deg, #a855f7, #ec4899); transform: scale(1.05); cursor: pointer !important; }
    .btn-ready:hover { transform: scale(1.08); box-shadow: 0 0 30px rgba(236, 72, 153, 0.5); }
  </style>
 </head>
 <body class="h-full overflow-auto bg-gradient-to-br from-slate-900 via-purple-950 to-slate-900 text-white">
  <div class="min-h-full w-full relative flex items-center justify-center py-12 px-4">
   
   <div class="fixed inset-0 overflow-hidden pointer-events-none">
    <div class="absolute top-20 left-10 w-72 h-72 bg-purple-500/10 rounded-full blur-3xl"></div>
    <div class="absolute bottom-20 right-10 w-96 h-96 bg-pink-500/10 rounded-full blur-3xl"></div>
   </div>

   <div class="relative z-10 w-full max-w-2xl">
    
    <div class="flex items-center justify-center gap-6 mb-10 float-animation">
      <div class="w-16 h-16 md:w-20 md:h-20 rounded-2xl bg-white/5 backdrop-blur-md overflow-hidden flex items-center justify-center border border-white/20 shadow-2xl transition-transform hover:scale-110">
        <img src="https://scontent.fkkc3-1.fna.fbcdn.net/v/t39.30808-6/642768993_1941877609748834_2263063250765183521_n.jpg?_nc_cat=109&ccb=1-7&_nc_sid=7b2446&_nc_ohc=zYEj8N644KoQ7kNvwEWGI3a&_nc_oc=AdmlInMB5nE7eKoeYcbVBZaQ8dVC1YR60Q8sOgkh55L_2S0eUirMN-JvpRFp-D5Pp0s&_nc_zt=23&_nc_ht=scontent.fkkc3-1.fna&_nc_gid=nSWK6SUvzqaOygk2vcSyzQ&_nc_ss=8&oh=00_AfuxbGpyiELl2bLdxejMOTJnvQOjgOwOvkE9nC1pdqyBsw&oe=69A8656B" alt="Logo 1" class="w-full h-full object-cover">
      </div>
      <div class="w-24 h-24 md:w-28 md:h-28 rounded-full bg-white/5 backdrop-blur-md overflow-hidden flex items-center justify-center border-2 border-pink-500 shadow-[0_0_30px_rgba(236,72,153,0.3)] pulse-glow transition-transform hover:scale-110">
        <img src="https://scontent.fkkc3-1.fna.fbcdn.net/v/t39.30808-6/642355807_1941877579748837_136105529239050778_n.jpg?_nc_cat=110&ccb=1-7&_nc_sid=7b2446&_nc_ohc=kUoV0ShR7fIQ7kNvwGDER3t&_nc_oc=Adm2ZJBHyCBRkAiy17c-A-do5yysWtRHPOpRHDzQ5bNuLOHC3dXYV3kdvyLGeqrHHaw&_nc_zt=23&_nc_ht=scontent.fkkc3-1.fna&_nc_gid=N1dpVoag_NU39Z8bje0fbg&_nc_ss=8&oh=00_AfvbLM-rXHDemmRjXpvBM2vWQNFvEULMef4dV6SVq_oJwA&oe=69A864EB" alt="Logo 2" class="w-full h-full object-cover">
      </div>
      <div class="w-16 h-16 md:w-20 md:h-20 rounded-2xl bg-white/5 backdrop-blur-md overflow-hidden flex items-center justify-center border border-white/20 shadow-2xl transition-transform hover:scale-110">
        <img src="https://scontent.fkkc3-1.fna.fbcdn.net/v/t39.30808-6/642363058_1941877593082169_2123318853067314031_n.jpg?_nc_cat=110&ccb=1-7&_nc_sid=7b2446&_nc_ohc=LyXCWCf4NfYQ7kNvwEiK4Gu&_nc_oc=AdkXG3Agfqo9qVrJG_y4KTmz1Kyi77q6AceN7IJmluD6JRLql3geoAxIrkO_gUK9LVA&_nc_zt=23&_nc_ht=scontent.fkkc3-1.fna&_nc_gid=WerM0h9Nr5IarBcZKsMUAw&_nc_ss=8&oh=00_Aftdk7d1X1opIrfOlHSw7Ipua3AM24xig6dqS6-EKYD5ug&oe=69A867BC" alt="Logo 3" class="w-full h-full object-cover">
      </div>
    </div>

    <div class="gradient-border">
     <div class="glass-card rounded-3xl p-8 md:p-12">
      <div class="text-center mb-10">
       <span class="px-3 py-1 bg-purple-500/20 border border-purple-500/30 rounded-full text-xs font-semibold tracking-widest text-purple-300 uppercase mb-4 inline-block">By:Punyapat Aiamwworn</span>
       <h1 class="text-3xl md:text-5xl font-extrabold shimmer-text mb-4">Final Project</h1>
       <div class="h-1 w-20 bg-gradient-to-r from-purple-500 to-pink-500 mx-auto rounded-full"></div>
      </div>

      <div class="space-y-4 mb-10">
        <div class="bg-white/5 border border-white/10 p-5 rounded-2xl">
          <h3 class="text-pink-400 font-bold flex items-center gap-2 mb-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
            รายละเอียดการปรับปรุงล่าสุด
          </h3>
          <ul class="text-gray-300 text-sm md:text-base space-y-2 list-disc list-inside">
            <li>ได้แก้ไขในส่วนเสียงสัมภาษณ์ครูท่านแรกเรียบร้อยแล้ว</li>
            <li>เนื่องจากสาขากำหนดเวลาในการทำไม่เกิน 10 นาที</li>
            <li><span class="text-yellow-400">หมายเหตุสำคัญ:</span> จำเป็นที่จะต้องตัดบางส่วนออกและเพิ่มความเร็วในบางส่วน</li>
          </ul>
        </div>
      </div>

      <div class="flex flex-col items-center mb-10">
       <div class="relative w-32 h-32">
        <svg class="w-full h-full transform -rotate-90">
          <circle cx="50%" cy="50%" r="48" fill="none" stroke="rgba(147, 51, 234, 0.1)" stroke-width="6" />
          <circle id="progressRing" class="countdown-ring" cx="50%" cy="50%" r="48" fill="none" stroke="url(#gradient)" stroke-width="6" stroke-linecap="round" />
          <defs>
            <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#a855f7" /><stop offset="50%" stop-color="#ec4899" /><stop offset="100%" stop-color="#f97316" />
            </linearGradient>
          </defs>
        </svg>
        <div class="absolute inset-0 flex items-center justify-center">
          <span id="countdownNumber" class="text-5xl font-black text-white">10</span>
        </div>
       </div>
       <p id="countdownText" class="mt-4 text-gray-400 text-xs tracking-widest uppercase">Preparing final files...</p>
      </div>

      <button id="mainButton" disabled class="w-full py-5 px-8 rounded-2xl bg-gray-800 text-gray-500 font-bold text-xl transition-all duration-500 flex items-center justify-center gap-3 overflow-hidden relative group mb-8">
       <span id="buttonText">รวบรวมไฟล์ข้อมูล...</span>
      </button>

      <div class="flex justify-center mb-2">
        <a href="https://www.facebook.com/punyapat.aiamworn/" target="_blank" class="group relative inline-flex items-center justify-center p-[2px] rounded-full bg-gradient-to-r from-purple-500 via-pink-500 to-orange-500 transition-all duration-300 hover:scale-105 hover:shadow-[0_0_25px_rgba(236,72,153,0.6)]">
          <span class="flex items-center gap-3 px-6 py-2.5 rounded-full bg-[#171336] transition-all duration-300 group-hover:bg-transparent">
            <svg class="w-6 h-6 text-pink-500 group-hover:text-white transition-colors" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>
            <span class="font-semibold text-gray-200 group-hover:text-white tracking-wide">Editor: Punyapat Aiamworn </span>
          </span>
        </a>
      </div>

      <div class="mt-8 pt-6 border-t border-white/10 text-center text-xs text-gray-500">
        <span>© 2026 Final Project Delivery</span>
      </div>
     </div>
    </div>
   </div>
  </div>

  <script>
    const destinationUrl = 'https://drive.google.com/file/d/1CId_FfPJmIFWpsKBsvulwFzpS0K6gYjY/view?usp=sharing';
    let countdown = 10;
    let countdownInterval;

    function startCountdown() {
      const progressRing = document.getElementById('progressRing');
      const countdownNumber = document.getElementById('countdownNumber');
      const circumference = 2 * Math.PI * 48;
      progressRing.style.strokeDasharray = circumference;

      countdownInterval = setInterval(() => {
        countdown--;
        countdownNumber.textContent = countdown;
        progressRing.style.strokeDashoffset = circumference - (countdown / 10) * circumference;

        if (countdown <= 3) {
          document.getElementById('countdownText').textContent = 'Almost ready...';
          document.getElementById('countdownText').classList.add('text-pink-400');
        }

        if (countdown <= 0) {
          clearInterval(countdownInterval);
          enableButton();
        }
      }, 1000);
    }

    function enableButton() {
      const btn = document.getElementById('mainButton');
      const txt = document.getElementById('buttonText');
      
      btn.disabled = false;
      btn.classList.remove('bg-gray-800', 'text-gray-500');
      btn.classList.add('btn-ready', 'text-white', 'shadow-lg');
      txt.textContent = 'ดาวน์โหลดไฟล์งาน';
      document.getElementById('countdownNumber').innerHTML = '✓';
      document.getElementById('countdownText').textContent = 'Verification Complete';
      document.getElementById('countdownText').classList.replace('text-pink-400', 'text-green-400');
      
      btn.onclick = function() {
        txt.textContent = 'บันทึกข้อมูล...';
        
        const payload = JSON.stringify({
          action: "Open Final File",
          pageTitle: document.title,
          status: "User Clicked"
        });

        const newWindow = window.open(destinationUrl, '_blank');
        
        if (typeof google !== 'undefined' && google.script) {
          google.script.run
            .withSuccessHandler(() => {
              txt.textContent = 'ดาวน์โหลดแล้ว';
              if(!newWindow || newWindow.closed || typeof newWindow.closed=='undefined') {
                 window.location.href = destinationUrl;
              }
            })
            .withFailureHandler(() => {
              if(!newWindow || newWindow.closed || typeof newWindow.closed=='undefined') {
                 window.location.href = destinationUrl;
              }
            })
            .recordInteraction(payload);
        } else {
          window.location.href = destinationUrl;
        }
      };
    }

    window.onload = startCountdown;
  </script>
 </body>
</html>

